[{"path":"https://p0bs.github.io/DataKindR/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 DataKindR authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://p0bs.github.io/DataKindR/articles/postcodes-vignette.html","id":"our-example","dir":"Articles","previous_headings":"","what":"Our example","title":"Getting geographic metadata from UK postcodes","text":"’ll imagine scenario features five people, represented system id postcode. improve service, want learn people live.","code":"data <- tibble(   id = c(\"A1\", \"B1\", \"B2\", \"C1\", \"C2\", \"C3\"),   postcode = c(\"Me1 2re\", \"W1A 1AA \", \"N1\", \" SW1A 0AA\", \"XX1 0XX\", \"sw6 1hs\")   )  data #> # A tibble: 6 × 2 #>   id    postcode    #>   <chr> <chr>       #> 1 A1    \"Me1 2re\"   #> 2 B1    \"W1A 1AA \"  #> 3 B2    \"N1\"        #> 4 C1    \" SW1A 0AA\" #> 5 C2    \"XX1 0XX\"   #> 6 C3    \"sw6 1hs\""},{"path":"https://p0bs.github.io/DataKindR/articles/postcodes-vignette.html","id":"tidying-the-data","dir":"Articles","previous_headings":"","what":"Tidying the data","title":"Getting geographic metadata from UK postcodes","text":"can see, postcodes poorly formatted incomplete. tidy , ’ll use postcodes function exclude missing entries (partial postcode N1). postcodes now either structure missing. , can extract list use postcode API.","code":"data_tidy <- data |>    rowwise() |>    mutate(     postcode_clean = postcodes(       postcode_value = postcode,        postcode_type = \"full\"       )     ) |>    ungroup() |>    filter(!is.na(postcode_clean)) |>    rownames_to_column(var = \"postcode_number\") |>    mutate(postcode_number = as.integer(postcode_number))  data_tidy #> # A tibble: 5 × 4 #>   postcode_number id    postcode    postcode_clean #>             <int> <chr> <chr>       <chr>          #> 1               1 A1    \"Me1 2re\"   ME1 2RE        #> 2               2 B1    \"W1A 1AA \"  W1A 1AA        #> 3               3 C1    \" SW1A 0AA\" SW1A 0AA       #> 4               4 C2    \"XX1 0XX\"   XX1 0XX        #> 5               5 C3    \"sw6 1hs\"   SW6 1HS list_postcodes <- data_tidy |>    pull(postcode_clean)  list_postcodes #> [1] \"ME1 2RE\"  \"W1A 1AA\"  \"SW1A 0AA\" \"XX1 0XX\"  \"SW6 1HS\""},{"path":"https://p0bs.github.io/DataKindR/articles/postcodes-vignette.html","id":"getting-geographic-metadata-on-the-clean-postcodes","dir":"Articles","previous_headings":"","what":"Getting geographic metadata on the clean postcodes","title":"Getting geographic metadata from UK postcodes","text":"Despite cleaning, still issue, penultimate postcode correctly formatted real. therefore want ensure postcode (XX1 0XX) doesn’t cause entire run break, thereby stopping us getting information final postcode. , wrap API function safely function purrr package. now call postcode API list postcodes. output show? Well, seems result data four postcodes appropriately formatted genuine. now extract data, along metadata order postcodes list.","code":"safely_postcodes_metadata <- safely(postcodes_metadata) metadata_postcodes <- map(   .x = list_postcodes,    .f = ~safely_postcodes_metadata(postcode_value = .x)   )    glimpse(metadata_postcodes, width = 90) #> List of 5 #>  $ :List of 2 #>   ..$ result: tibble [1 × 18] (S3: tbl_df/tbl/data.frame) #>   ..$ error : NULL #>  $ :List of 2 #>   ..$ result: tibble [1 × 18] (S3: tbl_df/tbl/data.frame) #>   ..$ error : NULL #>  $ :List of 2 #>   ..$ result: tibble [1 × 18] (S3: tbl_df/tbl/data.frame) #>   ..$ error : NULL #>  $ :List of 2 #>   ..$ result: NULL #>   ..$ error :List of 8 #>   .. ..$ message: chr \"HTTP 404 Not Found.\" #>   .. ..$ trace  :Classes 'rlang_trace', 'rlib_trace', 'tbl' and 'data.frame':    17 obs. of  6 variables: #>   .. .. ..- attr(*, \"version\")= int 2 #>   .. ..$ parent : NULL #>   .. ..$ status : int 404 #>   .. ..$ resp   :List of 7 #>   .. .. ..- attr(*, \"class\")= chr \"httr2_response\" #>   .. ..$ request:List of 7 #>   .. .. ..- attr(*, \"class\")= chr \"httr2_request\" #>   .. ..$ rlang  :List of 1 #>   .. ..$ call   : language httr2::req_perform(req) #>   .. ..- attr(*, \"class\")= chr [1:6] \"httr2_http_404\" \"httr2_http\" \"httr2_error\" \"rlang_error\" ... #>  $ :List of 2 #>   ..$ result: tibble [1 × 18] (S3: tbl_df/tbl/data.frame) #>   ..$ error : NULL data_meta_postcodes <- tibble(   results = metadata_postcodes |> map(\"result\"),   error = metadata_postcodes |> map(\"error\")   ) |>    rowwise() |>    mutate(results_length = length(results)) |>    rownames_to_column(var = \"postcode_number\") |>    mutate(postcode_number = as.integer(postcode_number)) |>    filter(results_length == 18) |>    select(postcode_number, results) |>    unnest(results)   data_meta_postcodes #> # A tibble: 4 × 19 #>   postcode_number pcd   rgn   rgn_name pcon  pcon_name lsoa21 lsoa21_name msoa21 #>             <int> <chr> <chr> <chr>    <chr> <chr>     <chr>  <chr>       <chr>  #> 1               1 ME1 … E120… South E… E140… Chatham … E0101… Medway 026C E0200… #> 2               2 W1A … E120… London   E140… Cities o… E0100… Westminste… E0200… #> 3               3 SW1A… E120… London   E140… Cities o… E0100… Westminste… E0200… #> 4               5 SW6 … E120… London   E140… Chelsea … E0100… Hammersmit… E0200… #> # ℹ 10 more variables: msoa21_name <chr>, ward <chr>, ward_name <chr>, #> #   oac11_code <chr>, oac11_group <chr>, oac11_subgroup <chr>, #> #   oac11_supergroup <chr>, imd <int>, lat <dbl>, lon <dbl>"},{"path":"https://p0bs.github.io/DataKindR/articles/postcodes-vignette.html","id":"presenting-our-extended-data","dir":"Articles","previous_headings":"","what":"Presenting our extended data","title":"Getting geographic metadata from UK postcodes","text":"Finally, can rejoin results directly earlier datasets (.e. data_tidy data).","code":"data_full <- data_meta_postcodes |>    left_join(     data_tidy,      by = join_by(postcode_number == postcode_number)     ) |>    select(-postcode_number, -id)  data_final <- data |>    left_join(     data_full,      by = join_by(postcode == postcode)     ) |>    select(-postcode_clean) |>    select(id, postcode, everything())  data_final #> # A tibble: 6 × 20 #>   id    postcode  pcd   rgn   rgn_name pcon  pcon_name lsoa21 lsoa21_name msoa21 #>   <chr> <chr>     <chr> <chr> <chr>    <chr> <chr>     <chr>  <chr>       <chr>  #> 1 A1    \"Me1 2re\" ME1 … E120… South E… E140… Chatham … E0101… Medway 026C E0200… #> 2 B1    \"W1A 1AA… W1A … E120… London   E140… Cities o… E0100… Westminste… E0200… #> 3 B2    \"N1\"      NA    NA    NA       NA    NA        NA     NA          NA     #> 4 C1    \" SW1A 0… SW1A… E120… London   E140… Cities o… E0100… Westminste… E0200… #> 5 C2    \"XX1 0XX\" NA    NA    NA       NA    NA        NA     NA          NA     #> 6 C3    \"sw6 1hs\" SW6 … E120… London   E140… Chelsea … E0100… Hammersmit… E0200… #> # ℹ 10 more variables: msoa21_name <chr>, ward <chr>, ward_name <chr>, #> #   oac11_code <chr>, oac11_group <chr>, oac11_subgroup <chr>, #> #   oac11_supergroup <chr>, imd <int>, lat <dbl>, lon <dbl>"},{"path":"https://p0bs.github.io/DataKindR/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Robin Penfold. Author, maintainer.","code":""},{"path":"https://p0bs.github.io/DataKindR/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Penfold R (2024). DataKindR: Provides Helper Functions DataKind Volunteers. R package version 0.1.0, https://p0bs.github.io/DataKindR/, https://github.com/p0bs/DataKindR.","code":"@Manual{,   title = {DataKindR: Provides Helper Functions for DataKind Volunteers},   author = {Robin Penfold},   year = {2024},   note = {R package version 0.1.0, https://p0bs.github.io/DataKindR/},   url = {https://github.com/p0bs/DataKindR}, }"},{"path":"https://p0bs.github.io/DataKindR/index.html","id":"datakindr-","dir":"","previous_headings":"","what":"Provides Helper Functions for DataKind Volunteers","title":"Provides Helper Functions for DataKind Volunteers","text":"DataKind volunteers often need access specific data techniques DataDive project. goal DataKindR make easier volunteers access resources. Please note author package official affiliation DataKind UK (despite volunteered number times).","code":""},{"path":"https://p0bs.github.io/DataKindR/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Provides Helper Functions for DataKind Volunteers","text":"can install development version DataKindR GitHub :","code":"# install.packages(\"pak\") pak::pak(\"p0bs/DataKindR\")"},{"path":"https://p0bs.github.io/DataKindR/index.html","id":"access-to-resources","dir":"","previous_headings":"","what":"Access to resources","title":"Provides Helper Functions for DataKind Volunteers","text":"Whilst list may grow, DataKindR currently provides: Postcode cleansing Mapping postcodes geographical metadata  can think anything else, feel free contribute package. Thanks.","code":""},{"path":"https://p0bs.github.io/DataKindR/reference/DataKindR-package.html","id":null,"dir":"Reference","previous_headings":"","what":"DataKindR: Provides Helper Functions for DataKind Volunteers — DataKindR-package","title":"DataKindR: Provides Helper Functions for DataKind Volunteers — DataKindR-package","text":"DataKind volunteers often need access specific data techniques DataDive project. package seeks simplify access resources.","code":""},{"path":[]},{"path":"https://p0bs.github.io/DataKindR/reference/DataKindR-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"DataKindR: Provides Helper Functions for DataKind Volunteers — DataKindR-package","text":"Maintainer: Robin Penfold robin.penfold@icloud.com","code":""},{"path":"https://p0bs.github.io/DataKindR/reference/postcodes.html","id":null,"dir":"Reference","previous_headings":"","what":"Clean UK postcodes and extract their relevant elements — postcodes","title":"Clean UK postcodes and extract their relevant elements — postcodes","text":"function cleans UK postcode data returning relevant section (first part full postcode).","code":""},{"path":"https://p0bs.github.io/DataKindR/reference/postcodes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Clean UK postcodes and extract their relevant elements — postcodes","text":"","code":"postcodes(postcode_value, postcode_type = \"full\")"},{"path":"https://p0bs.github.io/DataKindR/reference/postcodes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Clean UK postcodes and extract their relevant elements — postcodes","text":"postcode_value postcode data cleaned (form 'N1 1AA', 'ME1 2RE' 'TN12 0QS'). postcode_type relevant section postcode return. one section permitted. Options : full full postcode ('N1 1AA') region first part first element postcode ('' 'ME1 2RE') area first element postcode ('ME1' 'ME1 2RE') locale area first part second element postcode ('ME1 2' 'ME1 2RE')","code":""},{"path":"https://p0bs.github.io/DataKindR/reference/postcodes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Clean UK postcodes and extract their relevant elements — postcodes","text":"","code":"postcodes(   postcode_value = 'ME1 2re ',   postcode_type = 'region'   ) #> [1] \"ME\""},{"path":"https://p0bs.github.io/DataKindR/reference/postcodes_metadata.html","id":null,"dir":"Reference","previous_headings":"","what":"Scrape geographic metadata about UK postcodes — postcodes_metadata","title":"Scrape geographic metadata about UK postcodes — postcodes_metadata","text":"function takes clean UK postcode data returns key geographic metadata. Details include: LSOA, MSOA, Latitude, Longitude, Deprivation Index Constituency.","code":""},{"path":"https://p0bs.github.io/DataKindR/reference/postcodes_metadata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scrape geographic metadata about UK postcodes — postcodes_metadata","text":"","code":"postcodes_metadata(postcode_value)"},{"path":"https://p0bs.github.io/DataKindR/reference/postcodes_metadata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Scrape geographic metadata about UK postcodes — postcodes_metadata","text":"postcode_value postcode data cleaned (form 'N1 1AA', 'ME1 2RE' 'TN12 0QS'). clean data, pass `postcodes` function package.","code":""},{"path":"https://p0bs.github.io/DataKindR/reference/postcodes_metadata.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Scrape geographic metadata about UK postcodes — postcodes_metadata","text":"","code":"postcodes_metadata(   postcode_value = \"ME1 2RE\"   ) #> # A tibble: 1 × 18 #>   pcd     rgn     rgn_name pcon  pcon_name lsoa21 lsoa21_name msoa21 msoa21_name #>   <chr>   <chr>   <chr>    <chr> <chr>     <chr>  <chr>       <chr>  <chr>       #> 1 ME1 2RE E12000… South E… E140… Chatham … E0101… Medway 026C E0200… Rochester … #> # ℹ 9 more variables: ward <chr>, ward_name <chr>, oac11_code <chr>, #> #   oac11_group <chr>, oac11_subgroup <chr>, oac11_supergroup <chr>, imd <int>, #> #   lat <dbl>, lon <dbl>"},{"path":"https://p0bs.github.io/DataKindR/news/index.html","id":"datakindr-010","dir":"Changelog","previous_headings":"","what":"DataKindR 0.1.0","title":"DataKindR 0.1.0","text":"Initial version postcodes postcodes_metadata functions Added NEWS.md file track changes package Added tests pkgdown standard package framework","code":""}]
